# 拉普拉斯滤波（Laplace Filter）

一种基于二阶导数（Laplacian算子）的边缘检测与图像增强方法。在图像处理中常用于突出灰度快速变化的区域（即边缘、细节），数学原理可以分为连续情形与离散情形两种。

## 连续情形下的拉普拉斯算子

在二维连续域中，设图像灰度函数为 $f(x,y)$，拉普拉斯算子定义为对 $f$的二阶偏导之和：
$$\Delta f(x,y)= \frac{\delta^2 f}{\delta x^2}(x,y) + \frac{\delta^2 f}{\delta y^2}(x,y)$$

- 物理意义：$\Delta f$衡量某点处灰度曲面的“曲率”或“凹凸”程度。对平坦区（灰度线性或常数）$\Delta f = 0$；对边缘处，因为灰度变化陡峭，$\Delta f$绝对值大，且跨过边缘会发生零交叉。
- 性质：
  1. 旋转不变性：$\Delta$ 对坐标旋转保持不变，能同时检测任意方向的边缘。
  2. 对噪声敏感：二阶导数在高频（噪声）处也会响应强烈，故通常先对图像做平滑，再做拉普拉斯。

## 离散情形下的拉普拉斯滤波

在数字图像中，图像离散为像素表格，二阶导用有限差分近似。常见的离散拉普拉斯卷积核（mask）有两种典型形式：

1. 四领域（4-neighbor）算子

$$L=\begin{bmatrix}
    0 & 1 & 0 \\
    1 & -4 & 1 \\
    0 & 1 & 0
\end{bmatrix}$$
其对应的卷积运算为
$$\Delta f[i,j] \approx f[i-1,j] + f[i+1,j] + f[i,j-1] + f[i,j+1] - 4f[i,j]$$

2. 八领域（8-neighbor）算子

$$L=\begin{bmatrix}
    1 & 1 & 1 \\
    1 & -8 & 1 \\
    1 & 1 & 1
\end{bmatrix}$$
其对应的卷积运算为
$$\Delta f[i,j] \approx \sum^1_{p=-1} \sum^1_{q=-1} f[i+p, j+q] - 8f[i,j]$$

两种算子本质相同，只是对角方向的加权是否计入。

## 实现步骤

1. （可选）预平滑

由于二阶导对噪声敏感，先用高斯卷积核对原图$I$做平滑：
$$I_s = G_{\delta} * I, G_{\delta}(x,y) = \frac{1}{2 \pi \delta^2}e^{-\frac{x^2+y^2}{2\delta^2}}$$

2. 应用拉普拉斯算子

$$L = I_s * L_{kernal}$$
其中$L_{kernal}$取上文的4领域或8领域模版。

3. 零交叉检测（可选）

如果只需检测边缘，可寻找拉普拉斯响应图中符号变化（正->负 或 负->正）的像素位置作为边缘像素。

## 数学原理

- 二阶微分边缘检测：一阶导数检测灰度变化最快处；二阶导数拉普拉斯强调变化率的变化，对细微纹理、尖锐边缘响应更强，但同时对噪声也很敏感。
- 零交叉：拉普拉斯结果中当像素点与领域的符号不同，即检测到一阶导的极值点，对应灰度斜坡中最陡处。

(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["riskRate"],{3086:function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("risk-rate-list")},r=[],s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"risk-rate-list"},[e.isListPage&&!e.enableSelector?i("div",{staticClass:"main-title"},[i("h1",[e._v("多样性配置")])]):e._e(),i("do-filter-panel",{on:{search:function(t){return e.search(!0)}}},[i("el-form",{attrs:{inline:"","label-width":"100px"},nativeOn:{submit:function(e){e.preventDefault()}}},[i("el-form-item",{attrs:{label:"产品"}},[i("allApps",{attrs:{"sync-to-store":!0},on:{change:function(t){return e.search(!0)}},model:{value:e.query.appId,callback:function(t){e.$set(e.query,"appId",t)},expression:"query.appId"}},[i("template",{slot:"prepend"},[i("el-option",{attrs:{value:"",label:"不限"}})],1)],2)],1),i("el-form-item",{attrs:{label:"渠道"}},[i("el-select",{attrs:{filterable:""},on:{change:function(t){return e.search(!0)}},model:{value:e.query.source,callback:function(t){e.$set(e.query,"source",t)},expression:"query.source"}},[i("el-option-group",[i("el-option",{key:"all",attrs:{value:"",label:"不限"}}),e._l(e.$MAPS.risk.channel.labelMap,(function(e,t){return i("el-option",{key:t,attrs:{value:t,label:e}})}))],2)],1)],1),i("el-form-item",{attrs:{label:"AID"}},[i("el-input",{attrs:{clearable:"",placeholder:"请输入AID"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.search(!0)}},model:{value:e.query.aid,callback:function(t){e.$set(e.query,"aid",t)},expression:"query.aid"}})],1)],1)],1),i("div",{directives:[{name:"loading",rawName:"v-loading",value:e.tableLoading,expression:"tableLoading"}],staticClass:"table-wrap do-card"},[i("div",{staticClass:"bd"},[i("el-table",{staticClass:"hide-border",attrs:{data:e.tableData,border:"",stripe:"","default-sort":{prop:e.defaultSort.prop,order:e.defaultSort.order}},on:{"sort-change":e.handleSortChange,"selection-change":e.changeSelectionRiskRate,"row-click":e.changeSelectionRiskRate}},[e.enableSelector?i("el-table-column",{attrs:{type:"selection",width:"55"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("el-checkbox",{directives:[{name:"show",rawName:"v-show",value:e.value[e.valueKey]+""===a[e.valueKey]+"",expression:"(value[valueKey] + '') === (row[valueKey] + '')"}],staticClass:"show-normal-checkbox",attrs:{checked:"",disabled:""}}),i("el-checkbox",{directives:[{name:"show",rawName:"v-show",value:!(e.value[e.valueKey]+""===a[e.valueKey]+""),expression:"!((value[valueKey] + '') === (row[valueKey] + ''))"}],staticClass:"show-normal-checkbox",attrs:{disabled:""}})]}}],null,!1,4152027107)}):e._e(),i("el-table-column",{attrs:{label:"所属产品","min-width":"110","show-overflow-tooltip":"",prop:"app"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[e._v(" "+e._s(e._f("pkgToName")(i.app))+" ")]}}])}),i("el-table-column",{attrs:{label:"渠道","min-width":"120","class-name":"name-slot-cell",prop:"source"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("div",{staticClass:"name"},[e._v(e._s(e._f("labelRiskChannel")(a.source)))])]}}])}),i("el-table-column",{attrs:{label:"AID","min-width":"120","class-name":"name-slot-cell","show-overflow-tooltip":"",align:"center",prop:"aid"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("div",{staticClass:"name"},[e._v(e._s(a.aid))])]}}])}),i("el-table-column",{attrs:{label:"冷静时间(秒)","min-width":"100",align:"right",prop:"intervalTime"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("div",{staticClass:"balance-td"},[a.intervalTime||0===a.intervalTime?i("span",{staticClass:"money mono"},[e._v(e._s(a.intervalTime))]):i("span",[e._v("-")])])]}}])}),e.enableSelector?e._e():i("el-table-column",{attrs:{"class-name":"ctrl-td",width:"180px",align:"right",fixed:"right",label:"操作"},scopedSlots:e._u([{key:"header",fn:function(){return[i("dialog-edit-risk-rate",{attrs:{"append-to-body":!0},on:{ok:function(t){return e.search(!0)}}},[i("div",{staticClass:"btn-add-risk-rate"},[e.writeable?i("el-button",{attrs:{size:"medium",icon:"el-icon-plus",type:"success",plain:""}},[e._v("新增配置")]):e._e()],1)])]},proxy:!0},{key:"default",fn:function(t){var a=t.row;return[e.writeable?i("dialog-edit-risk-rate",{attrs:{"risk-rate-line":a,"append-to-body":!0},on:{ok:function(t){return e.search(!1)}}},[i("el-button",{staticClass:"edit-risk-rate-btn",attrs:{plain:"",type:"primary",size:"mini"}},[i("i",{staticClass:"el-icon-edit"})])],1):e._e(),e.writeable?i("el-popconfirm",{staticClass:"delete-risk-rate-wrapper",attrs:{title:"确定要删除该多样性配置？"},on:{onConfirm:function(t){return e.deleteRiskRate(a)}}},[i("el-button",{staticClass:"delete-risk-rate-btn",attrs:{slot:"reference",plain:"",type:"danger",size:"mini"},slot:"reference"},[a.__deleting?i("i",{staticClass:"el-icon-loading"}):i("i",{staticClass:"el-icon-delete"})])],1):e._e()]}}],null,!1,2915666788)})],1)],1)]),i("base-pagination",{attrs:{"current-page":e.query.pageNum,"page-size":e.query.pageSize,total:e.total},on:{"current-change":e.handlePnChange,"size-change":e.handleSizeChange}})],1)},n=[],o=(i("d3b7"),i("ac1f"),i("841c"),i("96cf"),i("1da1")),l=i("5628"),c=function(e){var t=e.appId,i=e.source,a=e.aid,r=e.sequence,s=e.orderBy,n=e.pageNum,o=e.pageSize;return window.axios.get("/diverse/control/list",{params:{app:l["a"].apps.appIdToPkg[t],source:i,aid:a,sequence:r,orderBy:s,pageNum:n,pageSize:o}})},d=function(e){var t=e.appId,i=e.aid,a=e.source,r=e.intervalTime;return window.axios.post("/diverse/control/add",{app:l["a"].apps.appIdToPkg[t],aid:i,source:a,intervalTime:r})},u=function(e){var t=e.id,i=e.appId,a=e.aid,r=e.source,s=e.intervalTime;return window.axios.put("/diverse/control/update",{id:t,app:l["a"].apps.appIdToPkg[i],aid:a,source:r,intervalTime:s})},p=function(e){var t=e.id;return window.axios.delete("/diverse/control/delete/".concat(t))},f=i("619b"),m=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"dialog-edit-risk-rate"},[i("el-tooltip",{attrs:{disabled:!0,content:"",placement:"top"}},[i("div",{staticClass:"edit-risk-rate-tooltip",attrs:{slot:"content"},slot:"content"}),i("div",{staticClass:"click-edit-risk-rate",on:{click:e.showDialogEditRiskRate}},[e._t("default")],2)]),i("el-dialog",{ref:"refDialogEditRiskRate",staticClass:"dialog-edit-risk-rate-box",attrs:{visible:e.dialogEditRiskRate,"append-to-body":e.appendToBody},on:{closed:e.resetEditRiskRate,"update:visible":function(t){e.dialogEditRiskRate=t}}},[i("template",{slot:"title"},[i("span",{staticClass:"el-dialog__title"},[e._v(" "+e._s(e.isEdit?e.isPreview?"查看多样性配置":"编辑多样性配置":"新增多样性配置")+" "),e.isEdit?i("span",{staticClass:"tips"},[e._v("(ID: "+e._s(e.formEditRiskRate.id)+")")]):e._e()])]),i("section",{directives:[{name:"loading",rawName:"v-loading",value:e.requesting,expression:"requesting"}],staticClass:"edit-risk-rate-box"},[i("el-form",{ref:"refFormEditRiskRate",attrs:{model:e.formEditRiskRate,"label-width":e.formEditRiskRate.labelWidth,rules:e.formEditRiskRate.rules},nativeOn:{submit:function(e){e.preventDefault()}}},[i("el-form-item",{attrs:{prop:"appId",label:"应用名"}},[i("allApps",{attrs:{disabled:e.isEdit},model:{value:e.formEditRiskRate.appId,callback:function(t){e.$set(e.formEditRiskRate,"appId",t)},expression:"formEditRiskRate.appId"}})],1),i("el-form-item",{attrs:{label:"渠道",prop:"source"}},[i("el-select",{attrs:{filterable:""},model:{value:e.formEditRiskRate.source,callback:function(t){e.$set(e.formEditRiskRate,"source",t)},expression:"formEditRiskRate.source"}},e._l(e.$MAPS.risk.channel.labelMap,(function(e,t){return i("el-option",{key:t,attrs:{value:t,label:e}})})),1)],1),i("el-form-item",{attrs:{label:"AID",prop:"aid"}},[i("el-input",{attrs:{type:"text",autocomplete:"off",disabled:!e.formEditRiskRate.appId,placeholder:"请输入AID"},scopedSlots:e._u([{key:"append",fn:function(){return[e.formEditRiskRate.appId?i("el-button",{on:{click:e.showAidDialog}},[e._v("选择AID")]):e._e()]},proxy:!0}]),model:{value:e.formEditRiskRate.aid,callback:function(t){e.$set(e.formEditRiskRate,"aid","string"===typeof t?t.trim():t)},expression:"formEditRiskRate.aid"}}),i("aidSelectorDialog",{ref:"aidSelectorDialog",attrs:{pkg:e._f("appIdToPkg")(e.formEditRiskRate.appId)},model:{value:e.formEditRiskRate.aid,callback:function(t){e.$set(e.formEditRiskRate,"aid","string"===typeof t?t.trim():t)},expression:"formEditRiskRate.aid"}})],1),i("el-form-item",{attrs:{label:"冷静时间",prop:"intervalTime"}},[i("el-input",{attrs:{type:"text",autocomplete:"off",disabled:e.isPreview,placeholder:"请输入秒数"},model:{value:e.formEditRiskRate.intervalTime,callback:function(t){e.$set(e.formEditRiskRate,"intervalTime","string"===typeof t?t.trim():t)},expression:"formEditRiskRate.intervalTime"}},[i("template",{slot:"append"},[e._v("秒")])],2)],1)],1)],1),i("div",{staticClass:"edit-risk-rate-footer"},[e.isPreview?i("div",{staticClass:"edit-risk-rate-btn"},[i("el-button",{attrs:{size:"small"},on:{click:e.cancelEditRiskRate}},[e._v("关 闭")])],1):i("div",{staticClass:"edit-risk-rate-btn"},[i("el-button",{attrs:{size:"small"},on:{click:e.cancelEditRiskRate}},[e._v("取 消")]),i("el-button",{attrs:{type:"primary",loading:e.confirming,size:"small"},on:{click:e.confirmEditRiskRate}},[e._v("完 成")])],1)])],2)],1)},R=[],k=i("ffaa"),v={name:"DialogEditRiskRate",components:{aidSelectorDialog:k["a"]},props:{riskRateLine:{type:Object,default:function(){return null}},isPreview:{type:Boolean,default:function(){return!1}},appendToBody:{type:Boolean,default:function(){return!1}}},data:function(){return{dialogEditRiskRate:!1,requesting:!1,formEditRiskRate:{labelWidth:"110px",id:"",appId:"",source:"",aid:"",intervalTime:"",rules:{appId:[{required:!0,message:"请选择应用"}],source:[{required:!0,message:"请选择渠道"}],aid:[{required:!0,message:"请输入AID"}],intervalTime:[{required:!0,message:"请输入冷静时间"},{validator:this.$utils.validator.shouldBeInteger}]}},confirming:!1}},computed:{isEdit:function(){return!!this.formEditRiskRate.id}},methods:{reRender:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.riskRateLine){t.next=3;break}return e.requesting=!1,t.abrupt("return");case 3:e.formEditRiskRate.id=e.riskRateLine.id,e.formEditRiskRate.appId=e.$MAPS.apps.pkgToAppId[e.riskRateLine.app],e.formEditRiskRate.source=e.riskRateLine.source,e.formEditRiskRate.aid=e.riskRateLine.aid,e.formEditRiskRate.intervalTime=e.riskRateLine.intervalTime;case 8:case"end":return t.stop()}}),t)})))()},showDialogEditRiskRate:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.$emit("open"),e.dialogEditRiskRate=!0,e.requesting=!0,t.prev=3,t.next=6,e.reRender();case 6:t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](3),console.log(t.t0);case 11:return t.prev=11,e.requesting=!1,t.finish(11);case 14:case"end":return t.stop()}}),t,null,[[3,8,11,14]])})))()},cancelEditRiskRate:function(){this.dialogEditRiskRate=!1},resetEditRiskRate:function(){this.formEditRiskRate.id="",this.formEditRiskRate.appId="",this.formEditRiskRate.source="",this.formEditRiskRate.aid="",this.formEditRiskRate.intervalTime="",this.$refs.refFormEditRiskRate&&this.$refs.refFormEditRiskRate.resetFields(),this.$emit("close")},confirmEditRiskRate:function(){var e=this;this.$refs.refFormEditRiskRate&&this.$refs.refFormEditRiskRate.validate((function(t){if(t){if(e.confirming)return;var i;e.confirming=!0,i=e.isEdit?u(e.formEditRiskRate):d(e.formEditRiskRate),i.then((function(){e.$emit("ok"),e.$message({message:"".concat(e.isEdit?"编辑":"新增","多样性配置成功"),type:"success"}),e.dialogEditRiskRate=!1})).catch((function(){})).finally((function(){e.confirming=!1}))}}))},showAidDialog:function(){this.$refs.aidSelectorDialog.showPopper()}}},h=v,b=(i("a984"),i("aa9e"),i("2877")),g=Object(b["a"])(h,m,R,!1,null,"35fbc3dc",null),y=g.exports,w={name:"RiskRateList",components:{DialogEditRiskRate:y},mixins:[f["a"]],props:{isListPage:{type:Boolean,default:function(){return!0}},value:{type:Object,default:function(){return{}}},labelKey:{type:String,default:"aid"},valueKey:{type:String,default:"id"},enableSelector:{type:Boolean,default:function(){return!1}}},data:function(){var e={prop:"",order:""};return{showOverflowTooltip:!0,defaultSort:e,query:{appId:"",source:"",aid:"",orderBy:e.prop,sequence:e.order},selectedRiskRate:[]}},computed:{writeable:function(){return this.$HAS_PERMISSION("mango:risk-rate:w")}},created:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.tableLoading=!0,e.search(!0);case 2:case"end":return t.stop()}}),t)})))()},methods:{search:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];t&&(this.query.pageNum=1),this.tableLoading=!0,c(this.query).then((function(t){t&&(e.total=t.total,e.tableData=t.lists)})).finally((function(){e.tableLoading=!1}))},hideOverflowTooltip:function(){this.showOverflowTooltip=!1},enableOverflowTooltip:function(){this.showOverflowTooltip=!0},deleteRiskRate:function(e){var t=this;this.$set(e,"__deleting",!0),p(e).then((function(){t.$message({message:"多样性配置删除成功",type:"success"}),t.search()})).finally((function(){t.$set(e,"__deleting",!1)}))},changeSelectionRiskRate:function(e){if(this.enableSelector){var t=this.$utils.deepClone("array"===this.$utils.getRealType(e)?e[0]:e||{});this.$emit("input",t),this.$emit("on-change",t)}else this.selectedRiskRate=e}}},E=w,_=(i("6e13"),Object(b["a"])(E,s,n,!1,null,"2ca1b336",null)),x=_.exports,C={name:"FakeBlindProductManage",components:{RiskRateList:x}},S=C,I=Object(b["a"])(S,a,r,!1,null,null,null);t["default"]=I.exports},"3aa7":function(e,t,i){},"3c9d":function(e,t,i){},"6e13":function(e,t,i){"use strict";var a=i("3aa7"),r=i.n(a);r.a},"8eba":function(e,t,i){},a984:function(e,t,i){"use strict";var a=i("3c9d"),r=i.n(a);r.a},aa9e:function(e,t,i){"use strict";var a=i("8eba"),r=i.n(a);r.a}}]);
çŠ¶æ€æ¨¡å¼
    1.å®šä¹‰
        å¯¹æœ‰çŠ¶æ€çš„å¯¹è±¡æŠŠå¤æ‚çš„â€œåˆ¤æ–­é€»è¾‘â€æå–åˆ°ä¸åŒçš„çŠ¶æ€å¯¹è±¡ä¸­ï¼Œå…è®¸çŠ¶æ€å¯¹è±¡åœ¨å…¶å†…éƒ¨çŠ¶æ€å‘ç”Ÿæ”¹å˜æ—¶æ”¹å˜å…¶è¡Œä¸ºã€‚
    2.ä¼˜ç¼ºç‚¹
    ï¼ˆ1ï¼‰ä¼˜ç‚¹ï¼š
        ç»“æž„æ¸…æ™°ï¼ŒçŠ¶æ€æ¨¡å¼å°†ä¸Žç‰¹å®šçŠ¶æ€ç›¸å…³çš„è¡Œä¸ºå±€éƒ¨åŒ–åˆ°ä¸€ä¸ªçŠ¶æ€ä¸­ï¼Œå¹¶ä¸”å°†ä¸åŒçŠ¶æ€çš„è¡Œä¸ºåˆ†å‰²å¼€æ¥ã€‚
        å°†çŠ¶æ€è½¬æ¢æ˜¾ç¤ºåŒ–ï¼Œå‡å°‘å¯¹è±¡é—´çš„ç›¸äº’ä¾èµ–ã€‚
        çŠ¶æ€ç±»èŒè´£æ˜Žç¡®ï¼Œæœ‰åˆ©äºŽç¨‹åºçš„æ‰©å±•ã€‚
    ï¼ˆ2ï¼‰ç¼ºç‚¹ï¼š
        çŠ¶æ€æ¨¡å¼çš„ä½¿ç”¨ä¼šå¢žåŠ ç³»ç»Ÿçš„ç±»ä¸Žå¯¹è±¡çš„ä¸ªæ•°ã€‚
        çŠ¶æ€æ¨¡å¼çš„ç»“æž„ä¸Žå®žçŽ°è¾ƒä¸ºå¤æ‚ï¼Œä½¿ç”¨ä¸å½“ä¼šå¯¼è‡´ä»£ç æ··ä¹±ã€‚
    3.ç»“æž„
    ï¼ˆ1ï¼‰çŽ¯å¢ƒç±»ï¼šä¹Ÿç§°ä¸Šä¸‹æ–‡ï¼Œå®šä¹‰äº†å®¢æˆ·ç«¯éœ€è¦çš„æŽ¥å£ï¼Œå†…éƒ¨ç»´æŠ¤ä¸€ä¸ªå½“å‰çŠ¶æ€ï¼Œå¹¶è´Ÿè´£å…·ä½“çŠ¶æ€çš„åˆ‡æ¢ã€‚
    ï¼ˆ2ï¼‰æŠ½è±¡çŠ¶æ€ç±»ï¼šå®šä¹‰ä¸€ä¸ªæŽ¥å£ï¼Œç”¨æ¥å°è£…çŽ¯å¢ƒå¯¹è±¡ä¸­çš„çš„ç‰¹å®šçŠ¶æ€æ‰€å¯¹åº”çš„è¡Œä¸ºï¼Œå¯ä»¥æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªè¡Œä¸ºã€‚
    ï¼ˆ3ï¼‰å…·ä½“çŠ¶æ€ç±»ï¼šå®žçŽ°æŠ½è±¡çŠ¶æ€æ‰€å¯¹åº”çš„è¡Œä¸ºï¼Œå¹¶ä¸”åœ¨éœ€è¦çš„æƒ…å†µä¸‹è¿›è¡ŒçŠ¶æ€åˆ‡æ¢ã€‚
    4.å®žçŽ°
    //çŽ¯å¢ƒç±»
    class Context {
        private State state;

        public Context(){
            this.state = new ConcreteStateA();
        }

        public void setState(State state){
            this.state = state;
        }

        public State getState(){
            return (state);
        }

        public void Handler(){
            state.Handle(this);
        }
    }

    //æŠ½è±¡çŠ¶æ€ç±»
    abstract class State {
        public abstract void Handle(Context context);
    }

    //å…·ä½“çŠ¶æ€ç±»A
    class ConcreteStateA extends State {
        public void Handle(Context context){
            System.out.println("å½“å‰çŠ¶æ€æ˜¯ï¼šA");
            context.setState(new ConcreteStateA());
        }
    }

    //å…·ä½“çŠ¶æ€ç±»B
    class ConcreteStateB extends State {
        public void Handle(Context context){
            System.out.println("å½“å‰çŠ¶æ€æ˜¯ï¼šB");
            context.setState(new ConcreteStateB());
        }
    }
    5.ä¾‹å­ðŸŒ°ï¼š
    public interface State {
        //æŠ•å…¥25åˆ†é’±
        void insertQuarter();

        //é€€å›ž25åˆ†é’±
        void ejectQuarter();

        //è½¬åŠ¨æ›²æŸ„
        void turnCrank();

        //å‘æ”¾ç³–æžœ
        void dispense();
    }

    public class HasQuarterState implements State{
        private GumballMachine gumballMachine;

        public HasQuarterState(GumballMachine gumballMachine){
            this.gumballMachine = gumballMachine;
        }

        @Override
        public void insertQuarter(){
            System.out.println("You can't insert another quarter");
        }

        @Override
        public void ejectQuarter(){
            System.out.println("Quarter returned");
            gumballMachine.setState(gumballMachine.getNoQuarterState());
        }

        @Override
        public void turnCrank(){
            System.out.println("You turned...");
            gumballMachine.setState(gumballMachine.getSoldState());
        }

        @Override
        public void dispense(){
            System.out.println("No gumball dispensed");
        }
    }

    public class NoQuarterState implements State{
        private GumballMachine gumballMachine;

        public NoQuarterState(GumballMachine gumballMachine){
            this.gumballMachine = gumballMachine;
        }

        @Override
        public void insertQuarter(){
            System.out.println("You insert a quarter");
            gumballMachine.setState(gumballMachine.getHasQuarterState());
        }

        @Override
        public void ejectQuarter(){
            System.out.println("Yuo haven't insert a quarter");
        }

        @Override
        public void turnCrank(){
            System.out.println("You turned but there's no quarter");
        }

        @Override
        public void dispense(){
            System.out.println("You need pay first");
        }
    }

    public class SoldOutState implements State{
        private GumballMachine gumballMachine;

        public SoldOutState(GumballMachine gumballMachine){
            this.gumballMachine = gumballMachine;
        }

        @Override
        public void insertQuarter(){
            System.out.println("You can't insert a quarter, the machine is sold out");
        }

        @Override
        public void ejectQuarter(){
            System.out.println("You can't eject, you haven't inserted a quarter yet");
        }

        @Override
        public void turnCrank(){
            System.out.println("You turned, but there are no gumballs");
            gumballMachine.setState(gumballMachine.getSoldState());
        }

        @Override
        public void dispense(){
            System.out.println("No gumball dispensed");
        }
    }

    public class SoldState implements State{
        private GumballMachine gumballMachine;

        public SoldState(GumballMachine gumballMachine){
            this.gumballMachine = gumballMachine;
        }

        @Override
        public void insertQuarter(){
            System.out.println("Please wait, we're alreday giving you a gumball");
        }

        @Override
        public void ejectQuarter(){
            System.out.println("Sorry, you already turned the crank");
        }

        @Override
        public void turnCrank(){
            System.out.println("Turning twice doesn't get your another gumball!");
        }

        @Override
        public void dispense(){
            gumballMachine.releaseBall();
            if(gumballMachine.getCount > 0) {
                gumballMachine.setState(gumballMachine.getNoQuarterState());
            } else {
                System.out.println("Oops, out of gumballs");
                gumballMachine.setState(gumballMachine.getSoldState());
            }
        }
    }

    public class GumballMachine{
        private State soldOutState;
        private State noQuarterState;
        private State hasQuarterState;
        private State soldState;

        private State state;
        private int count = 0;

        public GumballMachine(int numberGumballs){
            count = numberGumballs;
            soldOutState = new SoldOutState(this);
            noQuarterState = new NoQuarterState(this);
            hasQuarterState = new HasQuarterState(this);
            soldOutState = new SoldOutState(this);

            if(numberGumballs > 0) {
                state = noQuarterState;
            } else {
                state = soldOutState;
            }
        }

        public void insertQuarter(){
            state.insertQuarter();
        }

        public void ejectQuarter(){
            state.ejectQuarter();
        }

        public void turnCrank(){
            state.turnCrank();
            state.dispense();
        }

        public void setState(State state){
            this.state = state;
        }

        public void releaseBall(){
            System.out.println("A gumball comes rolling out the slot...");
            if(count != 0){
                count -= 1;
            }
        }

        public State getSoldState(){
            return soldOutState;
        }

        public State getNoQuarterState(){
            return noQuarterState;
        }

        public State getHasQuarterState(){
            return hasQuarterState;
        }

        public State getSoldOutState(){
            return soldOutState;
        }

        public int getCount(){
            return count;
        }

    }

    public class Client {
        public static void main(String[] args){
            GumballMachine gumballMachine = new GumballMachine(5);

            gumballMachine.insertQuarter();
            gumballMachine.turnCrank();

            gumballMachine.insertQuarter();
            gumballMachine.ejectQuarter();
            gumballMachine.turnCrank();

            gumballMachine.insertQuarter();
            gumballMachine.turnCrank();
            gumballMachine.insertQuarter();
            gumballMachine.turnCrank();
            gumballMachine.ejectQuarter();

            gumballMachine.insertQuarter();
            gumballMachine.insertQuarter();
            gumballMachine.turnCrank();
            gumballMachine.insertQuarter();
            gumballMachine.turnCrank();
            gumballMachine.insertQuarter();
            gumballMachine.turnCrank();
        }
    }
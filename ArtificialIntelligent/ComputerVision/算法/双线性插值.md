# 双线性插值（Bilinear Interpolation）

双线性插值是将线性插值扩展到二维网格（如图像像素）上的方法。给定四个网格顶点上的数值，通过两次线性插值（先在一个方向，再在另一个方向）来估算网格内部任意一点的值。

## 算法步骤

1. 沿x方向插值
   - 在上下两条边分别对x做线性插值：
     $$R_1 = lerp(Q_{11}, Q_{21}; t_x) = (1 - t_x)Q_{11} + t_x Q_{21}$$
     $$R_2 = lerp(Q_{12}, Q_{22}; t_x) = (1 - t_x)Q_{12} + t_x Q_{22}$$
     其中 $t_x = \frac{x - x_0}{x_1 - x_0}$

2. 沿y方向插值
   - 再对 $R_1$ 与 $R_2$ 做线性插值：
     $$P = lerp(R_1, R_2; t_y) = (1 - t_y)R_1 + t_y R_2$$
     其中 $t_y = \frac{y - y_0}{y_1 - y_0}$

合并公式可得双线性插值的闭式：
$$P(x,y) = (1 - t_x)(1 - t_y)Q_{11} + t_x(1 - t_y)Q_{21} + (1 - t_x)t_yQ_{12} + t_xt_yQ_{22}$$

直观理解：

- 先在水平（或竖直）方向做一次线性插值，得到中间两个点。
- 再在垂直（或水平）方向做一次线性插值，得到目标点。

## 应用场景

- 图像缩放与旋转：常用于放大或旋转图像时，在新像素位置通过四邻域内的已知像素做插值。
- 数值求解：对二维网格数据（如地形高度场、温度场）做插值计算。
- 计算机图形学：纹理映射时对纹理坐标的值进行插值。

## 代码示例

```Python
import numpy as np

def bilinear_interp(Q11, Q21, Q12, Q22, x0, x1, y0, y1, x, y):
    tx = (x - x0) / (x1 - x0)
    ty = (y - y0) / (y1 - y0)
    R1 = (1 - tx) * Q11 + tx * Q21
    R2 = (1 - tx) * Q12 + tx * Q22
    P  = (1 - ty) * R1  + ty * R2
    return P
```
